select t12.time,
       count(udid) as c
from
    (select t1.udid,
            count(distinct t1.dt) as time
     from
         (select distinct dt,
                          udid
          from dws_bobo_logs.dws_bobo_sdk_all
          where dt >='20180203'
              and dt <='20180209'
              and eventid ='app_start') t1
     left join
         (select distinct dt,
                          udid
          from dws_bobo_logs.dws_bobo_sdk_all
          where dt >='20180203'
              and dt <='20180209'
              and eventid in ('play',
                              'refresh_by_pull_down',
                              'refresh_by_home_top_tab',
                              'refresh_by_home_bottom_tab',
                              'refresh_by_pull_up',
                              'refresh_by_last_tip')) t2 on t1.udid = t2.udid
     and t1.dt = t2.dt
     where t2.udid is null
     group by t1.udid) t12
group by t12.time