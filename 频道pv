SELECT t1.chanid,
       t1.uv,
       t2.vv
FROM
  (SELECT PARAMETERS['channelid'] AS chanid,
                    count(DISTINCT udid) AS uv
   FROM dwd_logs.dwd_bobo_fast
   WHERE dt = '20171228'
     AND eventid = 'cate_list_visit'
   GROUP BY PARAMETERS['channelid']) t1
LEFT JOIN
  (SELECT PARAMETERS['channelid'] AS chanid,
                    count(CASE
                              WHEN eventid='play' THEN 1
                              ELSE NULL
                          END) AS vv
   FROM dws_bobo_logs.dws_bobo_sdk_all
   WHERE dt = '20171228'
     AND eventid = 'play'
   GROUP BY PARAMETERS['channelid']) t2 ON t1.chanid = t2.chanid
